\documentclass[12pt,a4paper]{article}
\usepackage{times}
\usepackage{durhampaper}
\usepackage{harvard}
\usepackage{graphicx}

\graphicspath{}

\citationmode{abbr}
\bibliographystyle{agsm}

\title{Reinforcement Learning, Looking for New Backgammon Strategies}
\author{Fatema Alkhanaizi}
\student{Fatema Alkhanaizi}
\supervisor{Rob Powell}
\degree{BSc Computer Science}

\date{}

\begin{document}

\maketitle

\begin{abstract}
\subsection{Context/Background}
TD-Gammon  of Tesauro \cite{DBLP:conf/icml/Tesauro92,DBLP:journals/ai/Tesauro02} had demonstrated the impressive ability of machine learning techniques to learn to play games. TD-Gammon used reinforcement learning techniques with a Neural Network (NN) that trains itself to be an evaluation function for the game of backgammon, by playing against itself and learning from the outcome \cite{DBLP:journals/ai/Tesauro02}. However, the monolithic nueral network soon reached its limitation an outcome studied by Boyan \cite{} and a modular nueral network becomes more suitable to over come this limitation. The newest software for Backgammon build on top of the modular architecture such as eXtreme Gammon \cite{exg} and GNUBG \cite{gnubg}.
\subsection{Aims}
The aim of this project is to study the influence of including a hybrid of known backgammon strategies such as Priming and Back games as part of the nueral network architecture and to find a combination of strategies to maximize the performance. 
\subsection{Method}
Initially the nueral network from Tesauro's TD Gammon will be implemented and trained. This network will be referred to as monolithic nueral network. Then, multiple Modular Nueral Networks that include hybrid of backgammon strategies will be implemented and trained. 
\subsection{Proposed Solution}

\end{abstract}
\begin{keywords}
Backgammon; Reinforcement Learning; Modular Nueral Network; 
\end{keywords}

\section{Introduction}
This section briefly introduces the project, the research question you are addressing.  Do not change the font sizes or line spacing in order to put in more text.

Note that the whole report, including the references, should not be longer than 12 pages in length (there is no penalty for short papers if the required content is included). There should be at least 5 referenced papers.

\subsection{Backgammon Game}
Game rules followed and game set up.

\subsection{TD Gammon}
first implementation, limitations

\subsection{Searching Algorithm}
depth of lookup to choose the best action for the current turn (1-ply, 2-ply ... etc)

\subsection{Learning Method}

\subsection{Nueral Network architecture}

\subsection{Research Questions}

\section{Design}

This section presents the proposed solutions of the problems in detail. The design details should all be placed in this section. You may create a number of subsections, each focusing on one issue.

\subsection{Requirements}
\begin{table}[htb]
    \centering
    \caption{List of Functional Requirements}
    \vspace*{6pt}
    \label{req}
    \begin{tabular}{cp{12cm}c}
        \hline
        \hline
        ID & Requirement & Priority \\ 
        \hline
        FR1 & A module for Backgammon game must be implemented. This will include the actual board setup with the rules and constraints of the game e.g. legal moves and the dice role & High \\
        \hline
        FR2 & An AI agent should be created such that it uses a nueral network to evaulate legal moves/actions to play backgammon and a greedy search algorithm to pick the best legal move/action & High \\
        \hline
        FR3 & A module for the nueral network should be created. It should support the funtionalities required for the nueral network e.g. updating weights through back-propagation, saving and restoring the network meta-data & High \\
        \hline
        FR3 & A module for the training and testing the nueral network should be created & High \\
        \hline
        FR3 & Monolithic Nueral Network should be implemented and trained based on Tesauro's TD Gammon & High \\
        \hline
        FR4 & Modular Nueral Network that includes Racing Game strategy should be implemented and trained & High \\
        \hline
        FR5 & Modular Nueral Network that includes Racing and Holding Game strategies should be implemented and trained & High \\
        \hline
        FR6 & Modular Nueral Network that includes Racing and Priming Game strategies should be implemented and trained & High \\
        \hline
        FR7 & Modular Nueral Network that includes Racing, Holding and Priming Game strategies should be implemented and trained & High \\
        \hline
        FR8 & depth (n-ply) search algorithm should be implemented and incoporated into AI agent in FR2 & Medium \\
        \hline
        FR9 & Textual User interface for a Human agent to play against the AI agent from FR2 should be implemented & Medium \\
        \hline
        FR10 & Graphical User interface for a Human agent to play against the AI agent from FR2 should be implemented & Low \\
        \hline
        FR10 & Create a hueritic function for deciding when to include the doubling cube & Low \\
        \hline
        
    \end{tabular}
\end{table}
\begin{table}[htb]
    \centering
    \caption{List of Non-functional Requirements}
    \vspace*{6pt}
    \label{req}
    \begin{tabular}{cp{12cm}c}
        \hline
        \hline
        ID & Requirement & Priority \\ 
        \hline
        NFR1 & Trained networks should return the outcome from forward propagation within 40ms & Medium \\
        \hline
        NFR2 & The AI agent should pick a legal move/action within 1s. In other word the search algorithm for the best move/action should return a value within 1s & Medium \\
        \hline
    \end{tabular}
\end{table}
\subsection{Algorithms}
\subsubsection{Reinforcement Learning}
- Define Reinforcement Learning components in term of Backgammon

- Temporal difference learning

- value function with nueral network (backprobogation)

- after state value function

\subsubsection{Depth search algorithm}

\subsection{Nueral Network Architecture} \label{modnet}
For the Monolithic Nueral Network, it will be based on Tesauro's TD Gammon implementation. A fully-connected feed-forward nueral networks with a single hidden layer. The architecture consists of one input layer with 296 inputs units which consists of raw inputs representing the checkers configuration on the board and expert features mentioned in table-\ref{exfeat}).
\begin{table}[htb]
    \centering
    \caption{Expert features for each player}
    \vspace*{6pt}
    \label{exfeat}
    \begin{tabular}{cp{12cm}}
        \hline
        \hline
        Feature name & Description \\ 
        \hline
        x\_token & 1 if the player is playing with x token perspective, 0 otherwise \\
        \hline
        o\_token & 1 if the player is playing with o token perspective, 0 otherwise \\
        \hline
        bar\_pieces & number of checkers held on the bar for a player\\
        \hline
        pip\_count & pip count for a player \\
        \hline
        off\_pieces & percentage of pieces that a player has beared off \\
        \hline
        hit\_pieces & percentage of pieces that are at risk of being hit (single checker in a position which the opponent can hit) for a player \\
        \hline
    \end{tabular}
\end{table}

The modular nueral networks that will be implemented for this project consist of a combination of the following networks:
\begin{enumerate}
    \item One network for racing game; the checkers cannot be hit anymore by another checker or the checkers layout is close to this outcome
    \item One network for back/holding game positions; the player has some checkers on the bar or two or more checkers in 18, 19, 20 or 21 point
    \item One network for priming game; if the player has a prime of 4-5 fields (a long wall of checkers)
    \item One default network for all other positions
\end{enumerate}
Initially all networks will have the same layout as the monolithic nueral network, however the networks don't necessarly need to have the same layout. Different layouts will be tested to configure each nueral network e.g. racing game network does not need inputs for all fields since most checkers will be beared off or close to being beared off.

\subsubsection{Designer Domain Decomposition Architecture}

\subsubsection{Meta-Pi Networks}
- This network will replace the gating program. It will be used to determine the best nueral network to be triggered based on a give input. The benefit of this approach is that it could discover that some conditions in the gating program that used to trigger one nueral network might be more fitting for another network to handle such input; reduce the stiffness introduced by hard coding the triggers for the sub-networks. This will allow the agent to develop a more flexible strategy and eventually better decisions.

\subsection{System Components}
Python 3.6 will used as the language for this project. The nueral networks will be implemented using tensorflow package with GPU support. The figure below shows the expected structure of the project.
\begin{figure}[htp] 
    \centering
    \begin{minipage}{0.6\textwidth}
        \centering
        \includegraphics[width=1\textwidth]{{backgammon}.png}
    \end{minipage}
    \caption{Backgammon board setup}
    \label{board}
\end{figure}

\subsubsection{Game}
The user interface for the game is not the focus of this project, so a pre-existing interface written by ... will used. The implementation will be refactored so it can be used in the project. This module will hold the game setup and define the rules and constraints of the game e.g. take an action, find legal moves, game board setup ... etc.

\subsubsection{Agents}
There are 3 types of agents will be implemented for this project, all agents will implement get\_action method: 
\begin{itemize}
    \item \textbf{A human agent}, an interactive agent which takes user inputs either from the command line or by capturing the user clicks though a GUI.
    \item \textbf{A random agent} picks a random move from the list of legal moves based on the dice role. This agent will be mainly used for testing.
    \item \textbf{AI agent} uses a modular nueral network to determine the action for the current turn. A list of legal moves is obtained from the game module and the best action is picked after running the outcome of each move through the network. The search algorithm implemented is greedy and at a single depth, 1-ply; the action with the maximum output is picked.
\end{itemize}

\subsubsection{Modnet}
This module defines the operations for extracting features from the game board, testing, training, reading and writing three kinds of modular nueral networks. The architecture of those networks is explained in section-\ref{modnet}. This module heavily depends on Subnet module. A game-specific gating program is implemented in this class which determines which subnetwork applies to a given set of extracted features.

\subsubsection{Subnet}
This module includes the Nueral Network implementation using tensorflow. It provides routines for storing and accessing model, checkpoints and summaries generated by tensorflow.  


\subsection{Training}
\subsection{Monolothic Nueral Network}
This network will be trained on 1 million games. 
\subsection{Modular Nueral Network}
\subsection{Meta-Pi Network}


\subsection{Testing and Evaluation}
As the networks are training, in every 5000 game, a test will be ran against the random player to check the current performance of the networks architecture implemented. 

\subsection{Extensions}


\subsection{References}

The list of cited references should appear at the end of the report, ordered alphabetically by the surnames of the first authors.  The default style for references cited in the main text is the  Harvard (author, date) format.  When citing a section in a book, please give the relevant page numbers, as in \cite[p293]{budgen}.  When citing, where there are either one or two authors, use the names, but if there are more than two, give the first one and use ``et al.'' as in  , except where this would be ambiguous, in which case use all author names.

You need to give all authors' names in each reference.  Do not use ``et al.'' unless there are more than five authors.  Papers that have not been published should be cited as ``unpublished'' \cite{euther}.  Papers that have been submitted or accepted for publication should be cited as ``submitted for publication'' as in \cite{futher} .  You can also cite using just the year when the author's name appears in the text, as in ``but according to Futher \citeyear{futher}, we \dots''.  Where an authors has more than one publication in a year, add `a', `b' etc. after the year.




\bibliography{projectpaper}


\end{document}